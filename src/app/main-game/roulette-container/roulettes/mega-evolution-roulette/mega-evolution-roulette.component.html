<h1 class="title">{{ wheelTitle | translate }}</h1>

<p class="subtitle" *ngIf="mode === 'select-mega-form'">{{ 'game.main.roulette.megaEvolution.selectingForm' | translate }}</p>

<div class="loading" *ngIf="isLoading">
  {{ 'game.main.roulette.megaEvolution.loading' | translate }}
</div>

<app-wheel
  *ngIf="!isLoading"
  [items]="wheelItems"
  (selectedItemEvent)="onItemSelected($event)">
</app-wheel>

<ng-template #megaEvolutionModal let-modal>
  <div class="modal-body" [style.box-shadow]="'0 0 30px ' + popupAnimationColor" [class]="'type-effect-' + popupTypeEffect">
    <h2 class="popup-title">Mega Evolution!</h2>

    <!-- Type-specific particle effects -->
    <div class="particle-container" [class]="'particles-' + popupTypeEffect">
      <div class="particle" *ngFor="let i of particleArray"></div>
    </div>

    <div class="evolution-panel">
      <div class="pokemon">
        <img
          class="sprite"
          [src]="popupBeforePokemon ? (popupBeforePokemon.shiny ? popupBeforePokemon.sprite?.front_shiny : popupBeforePokemon.sprite?.front_default) : ''"
          alt="Before">
        <div class="name">{{ (popupBeforePokemon?.text ?? '') | translate }}</div>
      </div>

      <div class="arrow" [style.color]="popupAnimationColor">âžœ</div>

      <div class="pokemon">
        <img class="sprite mega-glow" [src]="popupAfterSpriteUrl" alt="After" 
             [style.filter]="'drop-shadow(0 0 10px ' + popupAnimationColor + ')'">
        <div class="name" [style.color]="popupAnimationColor">{{ popupAfterName | translate }}</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" (click)="modal.close()">{{ 'game.main.roulette.megaEvolution.continue' | translate }}</button>
    </div>
  </div>
</ng-template>
